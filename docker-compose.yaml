version: "3.9"

services:
  hybrid-bot:
    container_name: hybrid-trading-bot
    build:
      context: .
      dockerfile: Dockerfile
    image: hybrid-trading-bot:latest
    restart: unless-stopped

    environment:
      APCA_API_KEY_ID: ${APCA_API_KEY_ID}
      APCA_API_SECRET_KEY: ${APCA_API_SECRET_KEY}
      SYMBOL: ${SYMBOL:-SPY}
      VOL_SYMBOL: ${VOL_SYMBOL:-SPY}
      POS_SYMBOL: ${POS_SYMBOL:-SPY}
      TIMEFRAME_HOURS: ${TIMEFRAME_HOURS:-1}
      MR_EXPOSURE: ${MR_EXPOSURE:-1.0}
      TF_EXPOSURE: ${TF_EXPOSURE:-1.0}
      VOL_Z_WINDOW: ${VOL_Z_WINDOW:-21}
      VOL_Z_ENTRY_THRESHOLD: ${VOL_Z_ENTRY_THRESHOLD:-0.0}
      BAND_STD_DEV: ${BAND_STD_DEV:-0.8}
      ATR_MULTIPLIER: ${ATR_MULTIPLIER:-3.0}
      LONG_ONLY: ${LONG_ONLY:-0}
      PAPER: ${PAPER:-1}
      DELAYED_BACKFILL: ${DELAYED_BACKFILL:-1}
      DASH_HOST: 0.0.0.0
      DASH_PORT: 8050

    ports:
      - "8050:8050"

    command: >
      python main.py

    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"
